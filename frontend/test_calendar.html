<!DOCTYPE html>
<html>
<head>
    <title>Test Status History Calendar</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; max-width: 500px; }
        .day { padding: 10px; border: 1px solid #ddd; text-align: center; min-height: 40px; }
        .day.has-events { background-color: #e3f2fd; font-weight: bold; }
        .day.selected { background-color: #2196f3; color: white; }
        .events { margin-top: 20px; padding: 10px; background: #f5f5f5; }
        .event { margin: 5px 0; padding: 5px; background: white; border-radius: 3px; }
        .interested { border-left: 4px solid #2196f3; }
        .interview-fixed { border-left: 4px solid #ff9800; }
        .selected { border-left: 4px solid #4caf50; }
    </style>
</head>
<body>
    <h1>Status History Calendar - Candidate 196712 (Manikandan)</h1>
    
    <h2>November 2025</h2>
    <div class="calendar" id="calendar"></div>
    
    <div class="events" id="events">
        <h3>Click on a highlighted date to see events</h3>
    </div>

    <script>
        // Sample data based on your database entries
        const statusHistory = {
            '2025-11-14': [{
                remarks: 'interested',
                client_name: 'Test Client',
                extra_notes: 'Initial candidate status when created',
                created_by: 'Emp/00100'
            }],
            '2025-11-15': [{
                remarks: 'interview fixed',
                client_name: 'Test Client', 
                extra_notes: 'Interview scheduled with client',
                created_by: 'Emp/00100'
            }],
            '2025-11-16': [{
                remarks: 'selected',
                client_name: 'Test Client',
                extra_notes: 'Candidate selected after interview', 
                created_by: 'Emp/00100'
            }]
        };

        function generateCalendar() {
            const calendar = document.getElementById('calendar');
            const year = 2025;
            const month = 10; // November (0-indexed)
            
            // Add day headers
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            dayHeaders.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day';
                dayHeader.style.fontWeight = 'bold';
                dayHeader.style.backgroundColor = '#f0f0f0';
                dayHeader.textContent = day;
                calendar.appendChild(dayHeader);
            });
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            // Generate calendar days
            for (let i = 0; i < 42; i++) { // 6 weeks
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'day';
                dayElement.textContent = currentDate.getDate();
                
                // Check if this date has events
                const dateKey = currentDate.toISOString().split('T')[0];
                if (statusHistory[dateKey]) {
                    dayElement.classList.add('has-events');
                    dayElement.style.cursor = 'pointer';
                    dayElement.onclick = () => showEvents(dateKey, statusHistory[dateKey]);
                }
                
                // Gray out dates not in current month
                if (currentDate.getMonth() !== month) {
                    dayElement.style.color = '#ccc';
                }
                
                calendar.appendChild(dayElement);
            }
        }
        
        function showEvents(date, events) {
            const eventsDiv = document.getElementById('events');
            eventsDiv.innerHTML = `<h3>Events for ${date}</h3>`;
            
            events.forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.className = `event ${event.remarks.replace(' ', '-')}`;
                eventDiv.innerHTML = `
                    <strong>${event.remarks.toUpperCase()}</strong><br>
                    <small>Client: ${event.client_name}</small><br>
                    <small>${event.extra_notes}</small><br>
                    <small>By: ${event.created_by}</small>
                `;
                eventsDiv.appendChild(eventDiv);
            });
        }
        
        // Initialize calendar
        generateCalendar();
        
        // Show summary
        document.body.innerHTML += `
            <div style="margin-top: 20px; padding: 10px; background: #e8f5e8; border-radius: 5px;">
                <h3>✅ Status History System Working!</h3>
                <p><strong>Database entries found:</strong> ${Object.keys(statusHistory).length} dates with events</p>
                <p><strong>Candidate:</strong> 196712 (Manikandan)</p>
                <p><strong>Client:</strong> Test Client</p>
                <p><strong>Status progression:</strong> interested → interview fixed → selected</p>
            </div>
        ` + document.body.innerHTML;
    </script>
</body>
</html>
